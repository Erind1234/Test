DECLARE @DynamicDate NVARCHAR(8);
SET @DynamicDate = REPLACE(CONVERT(NVARCHAR(8), DATEADD(DAY, -1, @[User::TodayDate]), 112), '-', '');

DECLARE @SQLQuery NVARCHAR(MAX);
SET @SQLQuery = N'SELECT GLAATCOMP,GLAATATLB,GLAATVADA,GLAATPARA,GLAATLOGL,GLAATCCYM,GLAATCDFL,GLAATAFCY,GLAATRATE,GLAATALCY,GLAATRES1,GLAATRES2,GLAATXRHS,GLAATPERI,GLAATCNTR,GLAATERGO,GLAFIL1,GLAFIL2,GLAFIL3,GLAFIL4
FROM OPENQUERY(live, ''SELECT GLAATCOMP,GLAATATLB,GLAATVADA,GLAATPARA,GLAATLOGL,GLAATCCYM,GLAATCDFL,GLAATAFCY,GLAATRATE,GLAATALCY,GLAATRES1,GLAATRES2,GLAATXRHS,GLAATPERI,GLAATCNTR,GLAATERGO,GLAFIL1,GLAFIL2,GLAFIL3,GLAFIL4
FROM XGLINTF.A'' + @DynamicDate + ''''')';

EXEC sp_executesql @SQLQuery;
